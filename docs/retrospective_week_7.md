# Sprint Retrospective Week #7
# 
| Issue   |      Task      | Assigned to | Estimated Effort per Task | Actual Effort per Task | Done | Notes |
|----------|:-------------:|------:| ------:|------:| ------:|------:|
|#15 System makes sure the reservation of lessons is correct for the time of day(lesson/ not lesson) 9:00-16:00 is lessons and 16:00-23:00 is not.|Let users delete lessons, change lesson details and make sure that changing and adding of lessons respects the time window|Elena and Jocelyn |4 Hours|3.5 Hours|Yes|In the implementation, 2 static methods and 5 endpoints were added. The saving endpoint was also changed in order to keep to the correct hours for lessons.|
|#7  The user shall create a unique string as they register. In case the user chooses to not do this step, the system shall create it instead of them. This is used as the username, together with the password, for authentication.|Revisit how the authentication service deals with usernames.|Jordan|1 Hour|1 Hour|Yes|After careful consideration we decided that the user should be able to enter a null username and receive a server generated string as a substitute. To do this I just added some null checks in the constructor in the authentication service and used java Util’s random UUID to create a pseudo random username.|
|#9 The system shall store passwords safely, secured by Spring|Revisit how the authentication service stores passwords.|Jordan|2 Hours|3 Hours|Yes|This step was delayed more than it should have. To implement safe password storing in the authentication service I used a BCrypt encoder to hash the passwords before they get saved in the database. Every password related logic had to be correctly adapted, including new tests.|
|All issues that has to do with reservation like #1 System shall allow users to register for lessons and #3 reserving equipment and all the issues that has to do with userservice and implement location builder pattern |Add more tests to boost test coverage|Natanael|5 Hours|~7 Hours|Yes|On the 21th of December I made a start with adding tests to boost the coverage in reservationservice and also the userservice and the location builder pattern. On the 6th I added tests for registerEquipment but it was more difficult because some services were broken via the api gateway. In some branches it did work and in others it didn’t, so I also spent a while on trying to find out where it was broken. But after that was fixed I could add tests, knowing that the method worked. Today, the 9th of December I boosted the userservice branch coverage to 96%, only needing the integration tests by the time this was written.|
|#3 The system shall allow users to reserve some equipment for timeslots with no lessons|Add the funcitonality that users can reserve equipment|Natanael|3 Hours|2.5 Hours|Yes|Making the functionality went pretty well, but after I was done I couldn’t manually test it because some services were broken via the api gateway. But at the end when it was fixed I checked this functionality and it worked.|
|#15 System makes sure that rooms are never overbooked (limited reservations per day and none at the same time); #19 Group reservations should also count toward the max amount of reservations for ALL team members.; #17. System makes sure that it is the correct number of reservations per type of subscriptions. Basic is one reservation max, and premium three reservations max.; #22 System should only allow groups of correct size and sport to reserve team sports halls; #24 System should check that all members of the group have enough remaining reservations.|Add all these check in location reservation|Yunhan|3 Hours|5 Hours|Yes|If we set the column name of a variable to camel case then we need to use underscores to separate words when querying using h2 and Jpa. For example: timeStart will have time_start as the column name. This task contains many checks and needs to communicate with many services which took so long to do and debug. I learned how to make queries in the H2 database |
|#25 System makes sure that the reservation of halls is correct for the time of day(lesson/ not lesson) 9:00-16:00 is lessons and 16:00-23:00 is not, such that halls can be reserved at this time.|Add an extra check for equipment and location reservation to check the time|Yunhan|< 1 Hour|< 1 Hour|Yes|In order to avoid letting the equipment or location be booked when there are lessons going on, this additional check is needed.|
|#33 System should allow admins to check who used the equipment last.|Add endpoint to monitor who used the equipment last|Yunhan|1 Hour|1 Hour|Yes|This endpoint allows us to check who used the equipment last in case the equipment is broken.|
|#32 Let user exit from his/her team|Add endpoint to let exit from his/ her team|Yunhan|1 Hour|1 Hour|Yes|This endpoint is needed since anyone in a team has the right to reserve. If someone in the team does not want to reserve, then he/she can safely exit.|

### Main Problems:

#####Problem:
We have not done research on mutation testing or software analytics tools yet and will need it for the upcoming assignments.


#####Solution:
Do individual research on topics we will need in order to be better prepared when the deadlines are approaching and we have to implement what we've learned.


### Personal weekly reports

#####Elena:
During Week 7 and the winter holidays, I worked on polishing up the Lesson Service, adding Javadoc, fixing the checkstyle and adding code analysis tools. I modified the saving endpoint in the Controller so that only lessons in the 09:00 - 15:00 time interval could be saved, lining up with the requirements from the scenario. I added methods to get the hour and minutes of the timestamp passed as an endpoint argument so that they could also be used when changing the time of lessons. Other endpoints included changing the capacity, location and sport (PUT mappings). In the case that a certain lesson gets cancelled, I also included an endpoint for deleting it. In the case of trying to save a lesson outside the timeframe or change its time to an hour that is not accepted, I created a 406 Not Acceptable HTTP Response class. After Lesson Service was finished up, I added the remaining Javadoc and fixed the checkstyle warnings. Then, I set up the project root gradle.build file so that it uses Jacoco Code Coverage to generate test coverage reports, and SpotBugs so that it points out Medium and High Priority Warnings, but also types like Bad practice or Malicious code vulnerability. It also includes useful details about location of said warnings and reason why they are reported for easier and faster improvement.

#####Yunhan:
During week 7 and the winter holidays. I implemented all remaining functionalities for reservation service. For example, reserving a location, checking equipment’s last user, etc. I needed to implement many checks there in order to validate reservations. I learned how to make queries in the H2 database. And one problem I had was that If we set the column name of a variable to camel case in a class then we need to use underscores to separate words when querying using h2 and Jpa. For example: timeStart will have time_start as the column name. This problem costs me a lot of time to solve.

#####Natanael:
These weeks I mostly added many tests to boost coverage. On the 21th of December I made a start with adding tests to boost the coverage in reservationservice and also the userservice and the location builder pattern.
Then I also fixed a bug in a loop with locationDTO.getsports, because there was a null pointer exception, but that was fixed with an if statement.
After that I added the functionality that users can reserve for equipment. When I was done, it was difficult to test since the facilityservice and userservice were broken via the api gateway.
On the 6th I added tests for registerEquipment but some services were still broken. In some branches it did work and in others it didn’t, so I also spent a while on trying to find out where it was broken and in which branches it wasn’t. It was fixed with Jordans help. After that was fixed, I could add tests, knowing that the method worked.
Today, the 9th of December I boosted the userservice branch coverage to 96%, only needing the integration tests, by the time this was written.

#####Jordan:
During the grace week/last week of coding I focused on cleaning up the code and boosting test code coverage. I revisited how the authentication service deals with usernames and passwords. Specifically the username can be null and replaced by a server generated UUID string. Furthermore the password (which cannot be null) must be stored safely in the database, for which I used BCrypt encryption. Once the last tasks were completed I worked on checkstyle, PMD and other static tests. The remaining time was spent working on the docs and fixing bugs with microservice communications, aka api gateway bugs.

#####Jocelyn:
This week I mostly worked more on adding a test for JWT Filter class and improving the coverage in lessonservice. I will add some integration tests for the lesson controller as well as do some border testing around the times between the beginning of the available hours and between the switch between lessons being available or rooms open for reservation. I will also write down some handwritten functional tests for how an actual user could test if the system is functioning correctly.

#####Paul:
This last week, I was mainly busy with polishing the software. I made tests, and made some classes more testible. I also did a lot of checkstyle fixes, because there was not much focus on that in earlier sprints. I also found some small bugs, which I then fixed. I did not implement any new feature this sprint, but I think that this sprint was more time consuming, which I find surprising.
